import {Logger, GzipHttp,window} from "server/lib";
const gzipHttp = plug('util/gzipHttp');

/**
 * 渲染JSON文件
 * @param {*} data 要输出的数据
 */
export let render = (data) => {
    let logger: Logger = plug('logger');
    let win = window;
    logger.debug('jsonRender.render(data) => ');
    logger.debug(data);


    let gzip: GzipHttp = gzipHttp.create({
        request: win.request,
        response: win.response,
        code: 200,
        contentType: 'application/json; charset=UTF-8'
    });
    try {
        gzip.write(data);
        gzip.flush();
    } catch (e) {
        logger.error(e.message + '\n' + e.stack);
    } finally {
        gzip.end();
    }
};
