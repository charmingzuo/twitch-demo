'use strict';

let path = require('path');
let url = require('url');
let map = require('./mod-map');

/**
 * 注意require写在里面是为了能清除缓存
 * @param {String} modAct mod_act字符串
 * @param req request
 * @param res response
 */
this.find = function (modAct, req, res) {
    let logger = plug('logger');
    let mod = map[modAct];

    if (!mod || modAct === 'default_page') {
        modAct = 'default_page';
        req.params.mod_act = modAct;
        mod = map[modAct];
    }

    if (typeof mod === 'string') {
        logger.info(`HTTP ${req.REQUEST.pathname}`);

        res.setHeader('Mod-Map', modAct + ':' + mod);
    }

    return require(mod);
};