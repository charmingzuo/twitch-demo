const twitchAPI = require('../../twitch/api');
const pugRender = require('../../common/view/pug-render');
const viewIndex = require('path').join(__dirname, './view/index.pug');
const limit = 20;

module.exports = (req, res) => {
    "use strict";

    let page = req.query.page || 1;

    twitchAPI.request(twitchAPI.apis.GAMES_TOP, {
        limit: limit,
        offset: limit * Math.max(page - 1, 1)
    }, (err, json)=> {
        pugRender.render(viewIndex, {
            template: {
                title: 'Top Games'
            },
            page: {
                games: json.top
            },
            err: err
        });
    });

};
